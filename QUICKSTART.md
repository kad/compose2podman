# compose2podman Quick Start

> **⚠️ WARNING: Proof-of-Concept Only**
>
> This tool was generated by GitHub Copilot as a demonstration and is **NOT intended for production use**.
> It has NOT been tested with real-world data. Always verify generated output before use.

## Installation

```bash
# From source
git clone https://github.com/kad/compose2podman.git
cd compose2podman
make build

# Or with go install
go install github.com/kad/compose2podman/cmd/compose2podman@latest
```

## Basic Usage

### Convert to Kubernetes YAML
```bash
# Auto-detect compose file (looks for compose.yaml, compose.yml, docker-compose.yaml, docker-compose.yml)
compose2podman

# Or specify file explicitly
compose2podman --input docker-compose.yaml --type kube --output pod.yaml

# Using short flags
compose2podman -i docker-compose.yaml -t kube -o pod.yaml -q

# Use with Podman
podman play kube pod.yaml
```

### Convert to Quadlet Files
```bash
# Long form
compose2podman --input docker-compose.yaml --type quadlet --output ./quadlet

# Short form
compose2podman -i docker-compose.yaml -t quadlet -o ./quadlet -q

# Install
cp quadlet/* ~/.config/containers/systemd/
systemctl --user daemon-reload
```

## Quick Examples

### Example 1: Redis
```yaml
# docker-compose.yaml
version: "3"
services:
  redis:
    image: redis:alpine
    ports:
      - "6379:6379"
```

```bash
# Auto-detect compose file in current directory
compose2podman -q
podman play kube pod.yaml

# Or specify file
compose2podman -i docker-compose.yaml -t kube -q
podman play kube pod.yaml
```

### Example 2: Web + Database
```yaml
# docker-compose.yaml
version: "3"
services:
  web:
    image: nginx:latest
    ports:
      - "80:80"
    depends_on:
      - db
  db:
    image: postgres:15
    environment:
      POSTGRES_PASSWORD: secret
    volumes:
      - db-data:/var/lib/postgresql/data
volumes:
  db-data:
```

```bash
# Kubernetes format (long form)
compose2podman --input docker-compose.yaml --type kube --pod-name myapp

# Short form
compose2podman -i docker-compose.yaml -t kube -p myapp -q

# Quadlet format (long form)
compose2podman --input docker-compose.yaml --type quadlet --output ./myapp-units

# Short form
compose2podman -i docker-compose.yaml -t quadlet -o ./myapp-units -q

# Install
sudo cp myapp-units/* /etc/containers/systemd/
sudo systemctl daemon-reload
sudo systemctl start web.service db.service
```

## Command Options

| Long Flag | Short | Default | Description |
|-----------|-------|---------|-------------|
| `--input` | `-i` | (auto-detect) | Input Compose file |
| `--type` | `-t` | `kube` | Output type: `kube` or `quadlet` |
| `--output` | `-o` | `pod.yaml` / `quadlet-output` | Output file or directory |
| `--pod-name` | `-p` | `compose-pod` | Pod name (Kubernetes only) |
| `--quiet` | `-q` | `false` | Suppress proof-of-concept warning |
| `--version` | `-v` | - | Show version |
| `--help` | `-h` | - | Show help message |

### Auto-Detection

When no `--input` is specified, compose2podman automatically searches for:
1. `compose.yaml` (preferred)
2. `compose.yml`
3. `docker-compose.yaml`
4. `docker-compose.yml`

This matches the behavior of `docker compose` command.

## Common Workflows

### Development
```bash
# Quick local testing (auto-detects compose file)
compose2podman -q
podman play kube pod.yaml

# Stop
podman play kube --down pod.yaml

# Or specify file explicitly
compose2podman -i docker-compose.yaml -t kube -q
podman play kube pod.yaml
```

### Production (Quadlet)
```bash
# Generate units (short form)
compose2podman -i docker-compose.yaml -t quadlet -o ./units -q

# Install system services
sudo cp units/* /etc/containers/systemd/
sudo systemctl daemon-reload

# Enable and start
sudo systemctl enable web.service db.service
sudo systemctl start web.service db.service

# Check status
sudo systemctl status web.service
```

### Testing Changes
```bash
# Rebuild after compose changes (auto-detect)
compose2podman -q

# Apply changes
podman play kube --replace pod.yaml

# Or with explicit file
compose2podman -i docker-compose.yaml -o pod.yaml -q
podman play kube --replace pod.yaml
```

## Troubleshooting

### Image not found
```bash
# Pull images first
podman pull nginx:latest
podman pull postgres:15
```

### Permission denied (Quadlet)
```bash
# Use user services instead
cp units/* ~/.config/containers/systemd/
systemctl --user daemon-reload
systemctl --user start web.service
```

### Port already in use
```bash
# Check what's using the port
sudo ss -tulpn | grep :80

# Or change port in compose file
ports:
  - "8080:80"  # Use 8080 instead
```

## Next Steps

- Read [README.md](README.md) for full documentation
- Check [EXAMPLES.md](EXAMPLES.md) for more examples
- See [CONTRIBUTING.md](CONTRIBUTING.md) to contribute

## Getting Help

- File issues: https://github.com/kad/compose2podman/issues
- Podman docs: https://docs.podman.io/
